<main class="flex-grow py-6 mainPage">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <!-- Account Summary -->
        <div class="mb-8">
            <h1 class="text-2xl font-bold text-gray-900 mb-6">Crypto Trading</h1>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- Cash Balance -->
                <div class="account-card rounded-lg shadow-lg p-6 text-white">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <p class="text-sm font-medium opacity-80">Cash Balance</p>
                        </div>
                        <svg class="h-6 w-6 opacity-80" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm.31-8.86c-1.77-.45-2.34-.94-2.34-1.67 0-.84.79-1.43 2.1-1.43 1.38 0 1.9.66 1.94 1.64h1.71c-.05-1.34-.87-2.57-2.49-2.97V5H10.9v1.69c-1.51.32-2.72 1.3-2.72 2.81 0 1.79 1.49 2.69 3.66 3.21 1.95.46 2.34 1.15 2.34 1.87 0 .53-.39 1.39-2.1 1.39-1.6 0-2.23-.72-2.32-1.64H8.04c.1 1.7 1.36 2.66 2.86 2.97V19h2.34v-1.67c1.52-.29 2.72-1.16 2.73-2.77-.01-2.2-1.9-2.96-3.66-3.42z"></path>
                        </svg>
                    </div>
                    <div class="mb-2">
                        <p class="text-2xl font-bold">$15,420.75</p>
                    </div>
                    <div class="text-xs opacity-80">
                        <p>Available for trading</p>
                    </div>
                </div>

                <!-- Live Crypto Rates Section -->
                <div class="col-span-2">
                    <div class="bg-white shadow-lg rounded-lg p-6">
                        <h2 class="text-xl font-bold text-gray-800 mb-4">Live Cryptocurrency Rates</h2>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <!-- Bitcoin Rate Card -->
                            <div class="bg-amber-100 rounded-lg p-4 shadow-sm">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="font-bold text-gray-800">Bitcoin</span>
                                    <svg class="h-6 w-6 text-amber-600" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M17.06 11.57c.59-.69.94-1.59.94-2.57 0-1.86-1.27-3.43-3-3.87V3h-2v2h-2V3H9v2H6v2h2v10H6v2h3v2h2v-2h2v2h2v-2.13c1.73-.44 3-2.01 3-3.87 0-.98-.35-1.88-.94-2.57zM10 7h4c1.1 0 2 .9 2 2s-.9 2-2 2h-4V7zm5 10h-5v-4h5c1.1 0 2 .9 2 2s-.9 2-2 2z"/>
                                    </svg>
                                </div>                                <p class="text-2xl font-bold text-gray-900">${{bitcoinPrice.toFixed(2)}}</p>
                                <p class="text-xs text-gray-600">BTCUSDT</p>
                            </div>

                            <!-- Ethereum Rate Card -->
                            <div class="bg-blue-100 rounded-lg p-4 shadow-sm">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="font-bold text-gray-800">Ethereum</span>
                                    <svg class="h-6 w-6 text-blue-600" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M11.944 17.97L4.58 13.62 11.943 24l7.37-10.38-7.372 4.35h.003zM12.056 0L4.69 12.223l7.365 4.354 7.365-4.35L12.056 0z"/>
                                    </svg>
                                </div>
                                <p class="text-2xl font-bold text-gray-900">${{ethereumPrice.toFixed(2)}}</p>
                                <p class="text-xs text-gray-600">ETHUSDT</p>
                            </div>

                            <!-- Cardano Rate Card -->
                            <div class="bg-indigo-100 rounded-lg p-4 shadow-sm">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="font-bold text-gray-800">Cardano</span>
                                    <svg class="h-6 w-6 text-indigo-600" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>
                                    </svg>
                                </div>
                                <p class="text-2xl font-bold text-gray-900">${{cardanoPrice.toFixed(2)}}</p>
                                <p class="text-xs text-gray-600">ADAUSDT</p>
                            </div>

                            <!-- Solana Rate Card -->
                            <div class="bg-purple-100 rounded-lg p-4 shadow-sm">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="font-bold text-gray-800">Solana</span>
                                    <svg class="h-6 w-6 text-purple-600" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>
                                    </svg>
                                </div>
                                <p class="text-2xl font-bold text-gray-900">${{solanaPrice.toFixed(2)}}</p>
                                <p class="text-xs text-gray-600">SOLUSDT</p>
                            </div>
                        </div>                        <div class="mt-4 text-xs text-gray-500">
                            <p>Real-time rates from Binance via WebSocket connection. Last update: {{formatDate(lastUpdated)}}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Cryptocurrency Charts Section -->
        <div class="mb-8">
            <h2 class="text-xl font-bold text-gray-900 mb-6">Price Charts</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Bitcoin Chart -->
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="font-bold text-lg text-gray-800">Bitcoin</h3>
                        <div class="text-amber-600 font-semibold">${{bitcoinPrice.toFixed(2)}}</div>
                    </div>
                    <div style="height: 250px;">
                        <canvas #bitcoinChart></canvas>
                    </div>
                </div>
                
                <!-- Ethereum Chart -->
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="font-bold text-lg text-gray-800">Ethereum</h3>
                        <div class="text-blue-600 font-semibold">${{ethereumPrice.toFixed(2)}}</div>
                    </div>
                    <div style="height: 250px;">
                        <canvas #ethereumChart></canvas>
                    </div>
                </div>
                
                <!-- Cardano Chart -->
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="font-bold text-lg text-gray-800">Cardano</h3>
                        <div class="text-indigo-600 font-semibold">${{cardanoPrice.toFixed(2)}}</div>
                    </div>
                    <div style="height: 250px;">
                        <canvas #cardanoChart></canvas>
                    </div>
                </div>
                
                <!-- Solana Chart -->
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="font-bold text-lg text-gray-800">Solana</h3>
                        <div class="text-purple-600 font-semibold">${{solanaPrice.toFixed(2)}}</div>
                    </div>
                    <div style="height: 250px;">
                        <canvas #solanaChart></canvas>
                    </div>
                </div>
            </div>
            <div class="mt-4 text-xs text-right text-gray-500">
                <p>Last updated: {{formatDate(lastUpdated)}}</p>
            </div>
        </div>

        

        <!-- Trading Section -->
        <div class="bg-white rounded-lg shadow-md overflow-hidden">
            <div class="px-6 py-4 border-b border-gray-200">
                <div class="flex space-x-8">
                    <button [class]="'tab px-1 py-2 text-sm font-medium ' + (activeTab === 'buy-sell' ? 'tab-active' : 'text-gray-500')" (click)="setActiveTab('buy-sell')">Buy / Sell</button>
                    <button [class]="'tab px-1 py-2 text-sm font-medium ' + (activeTab === 'portfolio' ? 'tab-active' : 'text-gray-500')" (click)="setActiveTab('portfolio')">Portfolio</button>
                </div>
            </div>

            <div class="p-6" *ngIf="activeTab === 'buy-sell'">
                <div class="grid grid-cols-1 gap-8">
                    <!-- Left Column: Trading Form -->
                    <div>
                        <h2 class="text-lg font-medium text-gray-900 mb-6">Trade Cryptocurrency</h2>

                        <form id="trade-form" (ngSubmit)="submitTradeForm()">
                            <div class="space-y-6">
                                <!-- Trade Type -->
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">I want to</label>
                                    <div class="flex space-x-4">
                                        <div class="flex-1">
                                            <button type="button" [class]="'w-full py-2 px-4 border rounded-md shadow-sm text-sm font-medium ' + (tradeType === 'buy' ? 'text-white bg-blue-600 hover:bg-blue-700 border-transparent' : 'text-gray-700 bg-white hover:bg-gray-50 border-gray-300')" (click)="setTradeType('buy')">
                                                Buy
                                            </button>
                                        </div>
                                        <div class="flex-1">
                                            <button type="button" [class]="'w-full py-2 px-4 border rounded-md shadow-sm text-sm font-medium ' + (tradeType === 'sell' ? 'text-white bg-blue-600 hover:bg-blue-700 border-transparent' : 'text-gray-700 bg-white hover:bg-gray-50 border-gray-300')" (click)="setTradeType('sell')">
                                                Sell
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <!-- Cryptocurrency -->
                                <div>
                                    <label for="cryptocurrency" class="block text-sm font-medium text-gray-700 mb-1">Cryptocurrency</label>
                                    <div class="relative">
                                        <select id="cryptocurrency" [(ngModel)]="selectedCrypto" name="cryptocurrency" class="block w-full pl-3 pr-10 py-2 text-base border border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md" (change)="updateEstimatedQuantity()">
                                            <option value="BTC">Bitcoin (BTC)</option>
                                            <option value="ETH">Ethereum (ETH)</option>
                                            <option value="ADA">Cardano (ADA)</option>
                                            <option value="SOL">Solana (SOL)</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- Amount -->
                                <div>
                                    <label for="amount" class="block text-sm font-medium text-gray-700 mb-1">Amount</label>
                                    <div class="mt-1 relative rounded-md shadow-sm">
                                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                            <span class="text-gray-500 sm:text-sm">$</span>
                                        </div>
                                        <input type="number" name="amount" id="amount" [(ngModel)]="tradeAmount" class="block w-full pl-7 pr-12 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none sm:text-sm" placeholder="0.00" (input)="updateEstimatedQuantity()">
                                        <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                            <span class="text-gray-500 sm:text-sm">USD</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Estimated Quantity -->
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Estimated Quantity</label>
                                    <div class="flex items-center justify-between bg-gray-50 rounded-md px-3 py-2">
                                        <span id="estimated-quantity" class="text-sm">{{estimatedQuantity}}</span>
                                        <span id="crypto-symbol" class="text-sm text-gray-500">{{selectedCrypto}}</span>
                                    </div>
                                </div>

                                <!-- Payment Method -->
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">{{tradeType === 'buy' ? 'Payment Method' : 'Deposit To'}}</label>
                                    <div class="relative">
                                        <select class="block w-full pl-3 pr-10 py-2 text-base border border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md" [(ngModel)]="selectedPaymentMethod" name="paymentMethod">
                                            <option value="cash">Cash Balance ($15,420.75)</option>
                                            <option value="checking">Checking Account (**** 4567)</option>
                                            <option value="credit">Credit Card (**** 1234)</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- Submit -->
                                <div class="pt-4">
                                    <button type="submit" class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                        {{tradeType === 'buy' ? 'Buy' : 'Sell'}} {{getCryptoName(selectedCrypto)}}
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>

                </div>
            </div>
            
            <div class="p-6" *ngIf="activeTab === 'portfolio'">
                <div class="grid grid-cols-1 gap-8">
                    <div>
                        <h2 class="text-lg font-medium text-gray-900 mb-6">Your Crypto Portfolio</h2>
                        <div class="bg-gray-50 rounded-lg p-8 text-center" *ngIf="portfolio.length === 0">
                            <p class="text-gray-500">You don't have any cryptocurrencies yet.</p>
                            <p class="text-gray-500 mt-2">Start buying crypto to build your portfolio.</p>
                            <button class="mt-4 inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500" (click)="setActiveTab('buy-sell'); setTradeType('buy')">
                                Start Trading
                            </button>
                        </div>
                        <div *ngIf="portfolio.length > 0" class="space-y-4">
                            <div *ngFor="let item of portfolio" class="bg-white border border-gray-200 rounded-lg p-4 flex justify-between items-center">
                                <div>
                                    <h3 class="font-medium">{{getCryptoName(item.symbol)}}</h3>
                                    <p class="text-sm text-gray-500">{{item.quantity}} {{item.symbol}}</p>
                                </div>
                                <div class="text-right">
                                    <p class="font-medium">${{(item.quantity * getCryptoPrice(item.symbol)).toFixed(2)}}</p>
                                    <p class="text-xs" [class]="item.profitLoss >= 0 ? 'text-green-600' : 'text-red-600'">
                                        {{item.profitLoss >= 0 ? '+' : ''}}{{item.profitLoss.toFixed(2)}}%
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>
