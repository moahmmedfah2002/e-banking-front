<div class="agent-management-container mainPage">
  <div class="header">
    <div class="header-content">
      <h1>Agent Management</h1>
      <p class="subtitle">Manage agents and permissions</p>
    </div>
    <button class="add-agent-btn" (click)="addNewAgent()">Add New Agent</button>
  </div>

  <div class="stats-cards">    <div class="stats-card total">
      <div class="stats-content">
        <div class="stats-label">Total Agents</div>
        <div class="stats-value">{{ totalAgents }}</div>
        <div class="stats-change" [class.positive]="totalChangePercent > 0" [class.negative]="totalChangePercent < 0">
          {{ totalChangePercent }}% from last month
        </div>
      </div>
      <div class="stats-icon total-icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
          <circle cx="9" cy="7" r="4"></circle>
          <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
          <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
        </svg>
      </div>
    </div>
    
    <div class="stats-card">
      <div class="stats-content">
        <div class="stats-label">Active Agents</div>
        <div class="stats-value">{{ activeAgents }}</div>
        <div class="stats-change" [class.positive]="activeChangePercent > 0" [class.negative]="activeChangePercent < 0">
          {{ activeChangePercent > 0 ? '+' : '' }}{{ activeChangePercent }}% from last month
        </div>
      </div>
      <div class="stats-icon active-icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
          <polyline points="22 4 12 14.01 9 11.01"></polyline>
        </svg>
      </div>
    </div>
    
    <div class="stats-card super">
      <div class="stats-content">
        <div class="stats-label">Super Agents</div>
        <div class="stats-value">{{ superAgents }}</div>
        <div class="stats-change">N/A</div>
      </div>
      <div class="stats-icon super-icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M20.42 4.58a5.4 5.4 0 0 0-7.65 0l-.77.78-.77-.78a5.4 5.4 0 0 0-7.65 0C1.46 6.7 1.33 10.28 4 13l8 8 8-8c2.67-2.72 2.54-6.3.42-8.42z"></path>
        </svg>
      </div>
    </div>
    
    <div class="stats-card">
      <div class="stats-content">
        <div class="stats-label">Inactive Accounts</div>
        <div class="stats-value">{{ inactiveAgents }}</div>
        <div class="stats-change" [class.positive]="inactiveChangePercent > 0" [class.negative]="inactiveChangePercent < 0">
          {{ inactiveChangePercent }}% from last month
        </div>
      </div>
      <div class="stats-icon inactive-icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
          <line x1="12" y1="9" x2="12" y2="13"></line>
          <line x1="12" y1="17" x2="12.01" y2="17"></line>
        </svg>
      </div>
    </div>
  </div>  <div class="agent-list-section">
    <h2>Agent List</h2>
    <div class="list-actions">
      <div class="search-bar">
        <input 
          type="text" 
          placeholder="Search by name, email, or phone" 
          [(ngModel)]="searchQuery"
          (input)="searchAgents()"
          class="search-input"
        >
      </div>
      <div class="list-filters">        <button class="filter-btn">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
          </svg>
          Filter
        </button>
        <div class="sort-dropdown">
          <button class="sort-btn">
            Sort by: <span>{{ selectedSort }}</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M6 9l6 6 6-6"></path>
            </svg>
          </button>
          <div class="dropdown-content">
            <a (click)="sortBy('Name')">Name</a>
            <a (click)="sortBy('DateCreated')">Date Created</a>
            <a (click)="sortBy('Status')">Status</a>
          </div>
        </div>
      </div>
    </div><div class="agent-list-table">
      <table>
        <thead>
          <tr>
            <th class="checkbox-column">
              <input type="checkbox">
            </th>
            <th>AGENT</th>
            <th>ROLE</th>
            <th>STATUS</th>
            <th>LAST LOGIN</th>
            <th>CREATED</th>
            <th>ACTIONS</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let agent of filteredAgents">
            <td class="checkbox-column">
              <input type="checkbox">
            </td>
            <td class="agent-info">
              <div class="agent-avatar" [attr.data-initials]="getAgentInitials(agent)">
                {{ getAgentInitials(agent) }}
              </div>
              <div class="agent-details">
                <div class="agent-name">{{ agent.prenom }} {{ agent.nom }}</div>
                <div class="agent-email">{{ agent.email }}</div>
              </div>
            </td>
            <td>
              <span class="role-badge" [ngClass]="{'super-badge': getAgentRole(agent) === 'Super Agent'}">
                {{ getAgentRole(agent) }}
              </span>
            </td>
            <td>
              <span class="status-badge" [ngClass]="{'active': agent.estActif, 'inactive': !agent.estActif}">
                {{ agent.estActif ? 'Active' : 'Inactive' }}
              </span>
            </td>
            <td>{{ formatDate(agent.dateCreation) }}</td>
            <td>{{ agent.dateCreation | date:'MMM d, yyyy' }}</td>            <td class="actions-column">
              <button class="action-btn edit" (click)="editAgent(agent)" title="Edit">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                  <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                </svg>
              </button>
              <button class="action-btn delete" (click)="deleteAgent(agent)" title="Delete">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <polyline points="3 6 5 6 21 6"></polyline>
                  <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                </svg>
              </button>
              <button class="action-btn more" title="More">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <circle cx="12" cy="12" r="1"></circle>
                  <circle cx="12" cy="5" r="1"></circle>
                  <circle cx="12" cy="19" r="1"></circle>
                </svg>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="table-footer">
      <p class="showing-text">Showing {{ filteredAgents.length }} agents</p>
    </div>
  </div>
</div>
